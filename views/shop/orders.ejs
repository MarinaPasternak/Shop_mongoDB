<%- include('../includes/head.ejs') %>
</head>

<body>
  <%- include('../includes/navigation.ejs') %>

  <main>
    <h1>Your Orders</h1>

    <% if (orders && orders.length > 0) { %> 
      <% orders.forEach((order, index) => { %>
        <section class="order">
          <h2> Order #<%= index + 1 %> - Created: <%= order.createdAt ? order.createdAt.toDateString() : 'Unknown date' %></h2>
          <ul class="no-style">
            <% order.products.forEach(product => { %>
              <li><%= product.title %> (Quantity: <%= product.quantity %>)</li>  
            <% }) %>
          </ul>
          <p>
            <strong>Total:</strong> $
            <%= order.products.reduce((sum, p) => sum + (p.product.price || 0) * p.quantity, 0).toFixed(2) %>
          </p>
        </section>
      <% }) %>
    <% } else { %>
      <p>No orders found!</p>
    <% } %>
  </main>

  <%- include('../includes/end.ejs') %>
</body>
